@page "/"
@using BlazorCRUD.Services;
@using BlazorCRUD.Data;
@inject NavigationManager Navigation
@inject GameCatalogService gameCatalogService;

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

<button class="btn btn-primary" @onclick='() => Navigation.NavigateTo("Create")'>Create</button>

<SurveyPrompt Title="How is Blazor working for you?" />

<table class="table table-dark table-striped">
    <thead>
        <tr>
            <th>Name</th>
            <th>Genre</th>
            <th>Release Date</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var g in games)
        {
            <tr>
                <td hidden="@g.Id"></td>
                <td>@g.Name</td>
                <td>@g.Genre</td>
                <td>@g.ReleaseDate</td>
                <td><button class="btn btn-warning"  >Update</button></td>
                <td><button class="btn btn-danger" @onclick="() => DeleteGame(g.Id)">Delete</button></td>
            </tr>
        }
    </tbody>
</table>

@code {

    private List<GameModel> games;

    protected override void OnInitialized() => games = gameCatalogService.GetGames();

    public void DeleteGame(int id)
    {
        var game = gameCatalogService.GetGameById(id);
        gameCatalogService.Delete(game.Id);
        Navigation.NavigateTo("/", true);
    }

}


